<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN" "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xml:lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns="http://www.w3.org/1999/html">
<head>
    <title>JSONpedia</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css"/>
    <style type="text/css">
        select {
            width: 70px;
        }
        .label {
            margin: 1px;
        }
    </style>

    <script type="text/javascript" src="jquery-1.7.2-min.js"></script>
    <script type="text/javascript" src="bootstrap-modal.js"></script>
    <script type="text/javascript" src="bootstrap-button.js"></script>
    <script type="text/javascript" src="bootstrap-dropdown.js"></script>
    <script type="text/javascript" src="bootstrap-tooltip.js"></script>
    <script type="application/javascript">
        $(function ($) {
            $.each($('.app-base-uri'), function () {
                $(this).text(document.location.host);
            });

            $('#app-path').text(document.location.pathname);
            $('#app-host').text(document.location.host);

            $('.example-button').click(function(e){
                $('#get-uri').val( $(e.target).html() );
                $('#get-submit').removeClass('disabled');
                e.preventDefault();
            })

            $.get('/annotate/flags').success(function(data){
                declared = Array.isArray(data.definedFlags) ? data.definedFlags : [data.definedFlags];
                defaultz = Array.isArray(data.defaultFlags) ? data.defaultFlags : [data.defaultFlags];
                for(var i=0; i < declared.length; i++) {
                    console.log('i:' + declared[i].id );
                    active = false;
                    for(var j=0; j < defaultz.length; j++) {
                        if(defaultz[j].id == declared[i].id) active = true;
                    }
                    addFlagButton( $('#get-flags') , 'get-'  + declared[i].id, declared[i].id, declared[i].description );
                    addFlagButton( $('#post-flags'), 'post-' + declared[i].id, declared[i].id, declared[i].description );
                }
                $("[rel=tooltip]").tooltip();
            });

            $('#get-uri').keyup(function(){
                $submitButton = $('#get-submit');
                if( $('#get-uri').val() != '' ) {
                    $submitButton.removeClass('disabled');
                } else {
                    $submitButton.addClass('disabled');
                }
            });

            $('#post-uri').keyup(function(){
                $submitButton = $('#post-submit');
                if( $('#post-uri').val() != '' ) {
                    $submitButton.removeClass('disabled');
                } else {
                    $submitButton.addClass('disabled');
                }
            });

            $('#get-submit').click(function () {
                if($('#get-submit').hasClass('disabled')) return;
                document.location.href =
                        '/annotate/resource/' +
                                $('#get-format option:selected').attr('value') +
                                '/' + encodeURIComponent($('#get-uri').val()) +
                                '?filter=' + $('#get-filter').val() +
                                '&flags=' + getActiveFlags('get-flags');
            });
            $('#post-submit').click(function () {
                if($('#get-submit').hasClass('disabled')) return;
                request = '/annotate/resource/' +
                        $('#post-format option:selected').attr('value') +
                        '/' + encodeURIComponent($('#post-uri').val());
                $.post( request,
                        {
                          wikitext : $('#post-wikitext').html(),
                          filter   : $('#post-filter').val(),
                          flags    : getActiveFlags('post-flags')
                        }
                )
                        .success(function (data) {
                            $('body').html(data.result);
                        })
                        .error(function (e) {
                            alert('Error while performing request: ' + e)
                        });
            });
        });

        function showModal(id) {
            $(id).modal('show');
        }

        function addFlagButton($root, id, name, description) {
            $root.append('<button id="' + id + '" rel="tooltip" data-placement="top" data-original-title="' + description + '" class="btn btn-primary' + (active ? ' active' : '') + '">'+ name + '</button>');
            $('#' + id).data('default-flag', active);
        }

        function getActiveFlags(container) {
            flags = '';
            $('#' + container + ' .btn').each(function(i,e){
                $e = $(e);
                if( $e.attr('class').indexOf('active') != -1) {
                    flags += $e.html() + ',';
                } else {
                    if( $e.data('default-flag') ) flags += '-' + $e.html() + ',';
                }
            });
            return flags;
        }
    </script>
</head>
<body>
<div class="container">

<div style="float: right;">
<a href="http://www.spaziodati.eu" target="_blank"><img src="http://spaziodati.eu/wp-content/uploads/2012/05/logo-e1335973319611.png"/></a>
</div>

<h1>JSONpedia - Live Service Demo</h1>

<p>Convert any MediaWiki document to JSON!</p>
<p>
Download and install JSONPedia: visit the
<a href="https://bitbucket.org/hardest/machinelinking" target="_blank">Developers Site</a> and the
<a href="https://bitbucket.org/hardest/machinelinking/wiki/Home" target="_blank">Documentation</a>.
</p>

<hr/>

<h2>Convert a Resource</h2>

<div class="well form-horizontal" method="get">
    <label>Pick an output format and enter the URI of a MediaWiki Resource:</label>
    <div class="control-group">
        <label class="control-label app-base-uri" for="get-format">http://...</label>
        <div class="controls">/
            <select id="get-format">
                <option value="json" selected="selected">json</option>
                <option value="html">html</option>
            </select>/
            <span class="btn-group">
                <span>
                    <input id="get-uri" type="text" style="width:400px" value="en:Albert_Einstein" placeholder="http://en.wikipedia.org/Albert_Einstein OR en:Albert_Einstein"/>
                    <button class="btn dropdown-toggle" data-toggle="dropdown">
                        <span class="caret"></span>
                    </button>
                       <ul class="dropdown-menu example-dropdown">
                           <li><a class="example-button" href="#">en:Albert_Einstein</a></li>
                           <li><a class="example-button" href="#">en:Cetacea</a></li>
                           <li><a class="example-button" href="#">en:Carbon</a></li>
                           <li><a class="example-button" href="#">en:Italy</a></li>
                           <li><a class="example-button" href="#">en:London</a></li>
                           <li><a class="example-button" href="#">en:Philosophy</a></li>
                           <li><a class="example-button" href="#">en:Star_Wars</a></li>
                       </ul>
                </span>
            </span>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">Filter:</label>
        <div class="controls">
            <input class="span11" id="get-filter" type="text" style="width:300px" placeholder="__type:link"/>
        </div>
    </div>

    <div class="control-group bs-docs-examples">
        <a href="#processors-doc"><span class="label pull-left well">Processors:</span></a>
        <span id="get-flags" class="btn-group" data-toggle="buttons-checkbox"></span>
    </div>

    <div class="form-actions">
        <button id="get-submit" type="button" class="btn btn-primary">Convert</button>
        <button type="reset" class="btn">Cancel</button>
    </div>
</div>
<hr/>

<h2>Convert a WikiText</h2>

<div class="well form-horizontal" method="post">
    <div class="control-group">
        <label class="control-label app-base-uri" for="post-format">http://...</label>
        <div class="controls">/
            <select id="post-format" name="format">
                <option value="json" selected="selected">json</option>
                <option value="html">html</option>
            </select>/<input id="post-uri" type="text" style="width:400px" value="en:Fake_Page" placeholder="http://en.wikipedia.org/wiki/Fake_Page OR en:Fake_Page"/>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">Filter:</label>
        <div class="controls">
            <input  class="span11" id="post-filter" type="text" style="width:300px" value=""/>
        </div>
    </div>

    <div class="control-group">
        <a href="#processors-doc"><span class="label pull-left well">Processors:</span></a>
        <div id="post-flags" class="btn-group" data-toggle="buttons-checkbox">
        </div>
    </div>

    <div class="control-group">
        <textarea id="post-wikitext" class="span11" rows="12">
            {{Infobox scientist
            | name = Albert Einstein
            | image = Einstein 1921 portrait2.jpg
            | caption = Albert Einstein in 1921
            | birth_date = {{Birth date|df=yes|1879|3|14}}
            | birth_place = [[Ulm]], [[Kingdom of Württemberg]], [[German Empire]]
            | death_date = {{Death date and age|df=yes|1955|4|18|1879|3|14}}
            | death_place = [[Princeton, New Jersey|Princeton]], New Jersey, United States
            | spouse = [[Mileva Marić]]&nbsp;(1903–1919)<br>{{nowrap|[[Elsa Löwenthal]]&nbsp;(1919–1936)}}
            | residence = Germany, Italy, Switzerland, Austria, Belgium, United Kingdom, United States
            | citizenship = {{Plainlist|
            * [[Kingdom of Württemberg|Württemberg/Germany]] (1879–1896)
            * [[Statelessness|Stateless]] (1896–1901)
            * [[Switzerland]] (1901–1955)
            * [[Austria–Hungary|Austria]] (1911–1912)
            * [[German Empire|Germany]] (1914–1933)
            * United States (1940–1955)
            }}
            }}
        </textarea>
    </div>

    <div class="form-actions">
        <button id="post-submit" type="button" class="btn btn-primary">Convert</button>
        <button type="reset" class="btn">Cancel</button>
    </div>
</div>

<hr/>

<!--------- BEGIN API Reference --------->

<h2>Quick API reference</h2>

<h3>Examples</h3>
<ul>
    <li><code><a href="/annotate/resource/json/http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FAlbert_Einstein"><span class="app-base-uri">http://...</span>/annotate/resource/json/http://en.wikipedia.org/wiki/Albert_Einstein</a></code>
    </li>
    <li><code><a href="/annotate/resource/html/http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FAlbert_Einstein"><span class="app-base-uri">http://...</span>/annotate/resource/html/http://en.wikipedia.org/wiki/Albert_Einstein</a></code>
    </li>
    <li><code><a href="/annotate/resource/json/http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FAlbedo"><span class="app-base-uri">http://...</span>/annotate/resource/json/http://en.wikipedia.org/wiki/Albedo</a></code>
    </li>
    <li><code><a href="/annotate/resource/html/http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FAlbedo"><span class="app-base-uri">http://...</span>/annotate/resource/html/http://en.wikipedia.org/wiki/Albedo</a></code>
    </li>
</ul>
<h3>Compact API</h3>

<p>HTTP GET requests can be made
    to URIs of the shape</p>
<pre><span class="app-base-uri">http://...</span>/<em>format</em>/<em>input-uri</em></pre>
<p>The response is the input document converted to the desired output format.</p>

<h3>Form-style GET API</h3>

<p>HTTP GET requests can be made to
    the URI
    <code class="app-base-uri">http://.../</code> with the following
    query parameters:
</p>
<table class="table">
    <tr>
        <th>uri</th>
        <td>URI of an input resource.</td>
    </tr>
    <tr>
        <th>format</th>
        <td>Desired output format, defaults to <code>json</code>.</td>
    </tr>
</table>
Such URL will return an HTTP <i>302</i> redirect to <code><span
        class="app-base-uri">http://...</span>/annotate/resource/<em>format</em></code>.<br/>

<p>The response is the input resource converted to the desired output format.</p>

<h3>Direct POST API</h3>

<p>HTTP POSTing a WikiText body to
    <code><span class="app-base-uri">http://...</span>/<em>format</em></code> will convert
    the WikiText to the specified output format.<br/>
    Typical media types for supported output formats are:
</p>
<table class="table">
    <tr>
        <th>Output format</th>
        <th>Media type</th>
    </tr>
    <tr>
        <th>JSON</th>
        <td><code>application/json</code></td>
    </tr>
    <tr>
        <th>HTML</th>
        <td><code>application/xhtml</code></td>
    </tr>
</table>

<h3>Form-style POST API</h3>

<p>A document body can also be converted by HTTP POSTing form data to
    <code><span class="app-base-uri">http://...</span>/</code>. <br/>
    The <code>Content-Type</code> HTTP header must be set to
    <code>application/x-www-form-urlencoded</code>.
    The following parameters are supported:
</p>
<table class="table">
    <tr>
        <th>format</th>
        <td>Desired output format; defaults to <code>json</code>.</td>
    </tr>
</table>

<h3>Output formats</h3>

<p>Supported output format identifiers are:</p>
<ul>
    <li><code>json</code> for <a href="http://json.org/" target="_blank">JSON</a>.</li>
    <li><code>html</code> for XHTML Compliant markup.</li>
</ul>

<h3>Error reporting</h3>

<p>Processing errors are indicated via
    HTTP status codes and brief <code>text/plain</code> error messages.
    The following status codes can be returned:</p>
<table class="table">
    <thead>
    <tr>
        <th>Code</th>
        <th>Reason</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <th>200 OK</th>
        <td>Success</td>
    </tr>
    <tr>
        <th>400 Bad Request</th>
        <td>Missing or malformed input parameter</td>
    </tr>
    <tr>
        <th>404 Not Found</th>
        <td>Malformed request URI</td>
    </tr>
    <tr>
        <th>502 Bad Gateway</th>
        <td>Input document from a remote server could not be fetched or parsed</td>
    </tr>
    </tbody>
</table>

<!--------- END API   Reference --------->

<!--------- BEGIN Processors Documentation --------->
<a name="processors-doc"></a>
<h2>Processors Documentation</h2>

<h3>Extractors</h3>
<p>Extract specific parts of content from the WikiText document stream.</p>

<h4>SectionExtractor</h4>
<p>Extracts the list of sections defined within the document.</p>
<pre class="well">
"sections": [
        {
            "title": "Biography",
            "level": 0
        },
        <span class="label label-warning">...</span>
]
</pre>

<h4>LinkExtractor</h4>
<p>Extracts the list of links (to external resources) defined within the document.</p>
<pre class="well">
"links": [
    {
        "link": "http://books.google.com/books?id=jJl2JAqvoSAC&pg=PA41",
        "description": "Chapter 2, p. 41"
    },
    <span class="label label-warning">...</span>
]
</pre>

<h4>ReferenceExtractor</h4>
<p>Extracts the list of links (to Wikipedia internal resources) defined within the document.</p>
<pre class="well">
"references": [
    {
        "label": "http://en.wikipedia.org/wiki/Albert_EinsteinUlm",
        "description": ""
    },
    <span class="label label-warning">...</span>
]
</pre>

<h4>TemplateOccurrencesExtractor</h4>
<p>Extracts statistics on template occurrences into the document.</p>
<pre class="well">
"templates": {
    "__type": "templates",
    "occurrences": {
        "Birth date": 1,
        "Block quote": 1,
        "Portal": 1,
        "Use dmy dates": 1,
        "Link GA": 2,
        "cite web": 12,
        <span class="label label-warning">...</span>
    }
}
</pre>

<h4>CategoriesExtractor</h4>
<p>Extracts the list of all declared categories into the document.</p>
<pre class="well">
"categories": {
    "__type": "category",
    "content": [
        "1879 births",
        "1955 deaths",
        "20th-century American people",
        "20th-century German people",
        "20th-century Swiss people",
        "American humanitarians",
        "American inventors",
        "American pacifists",
        "American people of German-Jewish descent",
        "Cosmologists",
        <span class="label label-warning">...</span>
    ]
}
</pre>

<h3>OnlineExtractors</h3>
<p><strong>Online Extractors</strong> are specific <strong>Extractors</strong> which rely on external services.</p>

<h4>TemplateMappingExtractor</h4>
<p>Extracts the RDF ontology mapping defined in DBpedia.org for every detected template into the document.</p>
<pre class="well">
"template-mapping": {
     "type": "mapping-collection",
     "mapping-collection": [
         {
             "__type": "template-mapping",
             "name": "TemplateMapping",
             "mapping": {
                 "notable_students": "notableStudent",
                 "death_date": "deathDate",
                 "birth_date": "birthDate",
                 "birth_name": "birthName",
                 "citizenship": "citizenship",
                 <span class="label label-warning">...</span>
             },
             "issues": null
         }
     ]
 }
</pre>

<h4>FreebaseExtractor</h4>
<p>Extracts the definition of the entity represented by the document from Freebase</p>
<pre class="well">
"freebase": {
    "alias": [
        "Einstein",
        "albert_einstein",
        "Einstein, Albert"
    ],
    "article": {
        "id": "/m/0jd6"
    },
    "guid": "#9202a8c04000641f800000000000417c",
    "id": "/en/albert_einstein",
    "image": {
        "id": "/wikipedia/images/commons_id/925243"
    },
    "name": "Albert Einstein",
    "relevance:score": 178.9317169189453,
    "type": [
        {
            "id": "/influence/influence_node",
            "name": "Influence Node"
        },
        {
            "id": "/award/award_winner",
            "name": "Award Winner"
        },
        {
            "id": "/business/board_member",
            "name": "Organization leader"
        },
        <span class="label label-warning">...</span>
    ],
    <span class="label label-warning">...</span>
}
</pre>

<h3>Splitters</h3>
<p>A <strong>Splitter</strong> cuts sub-trees of the <strong>WikiText DOM</strong> containing specific sections.</p>

<h4>InfoboxSplitter</h4>
<p>Splits out from the parsing DOM the <strong>Infobox</strong> section.</p>
<pre class="well">
"infobox-splitter": [
    {
        "__type": "template",
        "name": "Infobox scientist",
        "content": {
            "name": [
                "Albert Einstein"
            ],
            "image": [
                "Einstein 1921 portrait2.jpg"
            ],
            "caption": [
                "Albert Einstein in 1921"
            ],
            "birth_date": [
                {
                    "__type": "template",
                    "name": "Birth date",
                    "content": {
                        "3": null,
                        "14": null,
                        "1879": null,
                        "df": [
                            "yes"
                        ]
                    }
                }
            ],
            "birth_place": [
                {
                    "__type": "reference",
                    "label": "Ulm",
                    "description": ""
                },
                <span class="label label-warning">...</span>
            ],
            <span class="label label-warning">...</span>
        }
    }
]
</pre>

<h4>TableSplitter</h4>
<p>Splits out from the parsing DOM all the <strong>table</strong> sections.</p>
<pre class="well">
"table-splitter": [
     {
         "__type": "table",
         "content": [
             "class=wikitable",
             <span class="label label-warning">...</span>
             {
                 "__type": "head_cell",
                 "content": [
                     "Area of focus"
                 ]
             },
             {
                 "__type": "head_cell",
                 "content": [
                     "Received"
                 ]
             },
             <span class="label label-warning">...</span>
             {
                 "__type": "head_cell",
                 "content": [
                     "Significance"
                 ]
             },
             {
                 "__type": "body_cell",
                 "content": [
                     "''On a Heuristic Viewpoint Concerning the Production and Transformation of Light''"
                 ]
             },
             {
                 "__type": "body_cell",
                 "content": [
                     {
                         "__type": "reference",
                         "label": "Photoelectric effect",
                         "description": ""
                     }
                 ]
             },
             <span class="label label-warning">...</span>
         ]
    }
]
</pre>

<h3>Structure</h3>
<p>Prints out the <strong>entire DOM tree</strong> representation.</p>

<h3>Validate</h3>
<p>Prints out all warnings and errors detected during the document parsing.</p>
<pre class="well">
"issues": [
    {
        "type": "Warning",
        "description": "Invalid char '<' within comment tag.",
        "row": 307,
        "col": 65
    }
]
</pre>

<hr/>
<!--------- END   Processors Documentation --------->

<p><b>JSONpedia v.${project.version} (${implementation.build.tstamp})</b></p>

<p><a href="https://bitbucket.org/hardest/machinelinking" target="_blank">JSONpedia project homepage</a> |
    Hosted at <a href="http://bitbucket.org" target="_blank">BitBucket</a></p>

</div>

<footer class="footer">
    <div class="container-fluid" style="padding:50px">
        Copyright &copy;2012 The <a href="http://machinelinking.com/">MachineLinking</a>. All Rights Reserved.<br/>
    </div>
</footer>
</body>
</html>
